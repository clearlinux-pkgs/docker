From bc0afdef7b8ed39f2d3f70381df01b4ea75c4edb Mon Sep 17 00:00:00 2001
From: Dimitri John Ledkov <dimitri.j.ledkov@intel.com>
Date: Thu, 17 Sep 2015 11:02:14 +0100
Subject: [PATCH 4/4] Fix ups.
Organization: Intel Corporation (UK) Ltd. - Co. Reg. #1134945 - Pipers Way, Swindon SN3 1RJ

---
 daemon/execdriver/clr/driver.go | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

diff --git a/daemon/execdriver/clr/driver.go b/daemon/execdriver/clr/driver.go
index 8f22253..4aaa7f3 100644
--- a/daemon/execdriver/clr/driver.go
+++ b/daemon/execdriver/clr/driver.go
@@ -677,33 +677,35 @@ func (d *driver) setupNetwork(c *execdriver.Command) error {
 	var err error
 
 	for _, info := range c.EndpointInfo {
-		if info[netlabel.MacAddress].(net.HardwareAddr).String() == c.NetworkSettings.MacAddress {
-			bridgeName = info[netlabel.BridgeName].(string)
-			bridgeLinkName = info[netlabel.BridgeLinkName].(string)
+		if mac, ok := info[netlabel.MacAddress].(net.HardwareAddr); ok {
+			if mac.String() == c.NetworkSettings.MacAddress {
+				bridgeName = info[netlabel.BridgeName].(string)
+				bridgeLinkName = info[netlabel.BridgeLinkName].(string)
+			}
 		}
 	}
 
 	// Strip existing veth
 	cmd := exec.Command("ip", "link", "del", bridgeLinkName)
 	if output, err = cmd.CombinedOutput(); err != nil {
-		logrus.Debugf("%s setupNetwork error: %s %v, %s", driverName, cmd.Path, cmd.Args, output)
+		logrus.Debugf("%s setupNetwork error: %v, %s", driverName, cmd.Args, output)
 		return err
 	}
 
 	cmd = exec.Command("ip", "tuntap", "add", "dev", ifname, "mode", "tap", "vnet_hdr")
 	if output, err = cmd.CombinedOutput(); err != nil {
-		logrus.Debugf("%s setupNetwork error: %s %v, %s", driverName, cmd.Path, cmd.Args, output)
+		logrus.Debugf("%s setupNetwork error: %v, %s", driverName, cmd.Args, output)
 		return err
 	}
 	cmd = exec.Command("ip", "link", "set", "dev", ifname, "master", bridgeName)
 	if output, err = cmd.CombinedOutput(); err != nil {
-		logrus.Debugf("%s setupNetwork error: %s %v, %s", driverName, cmd.Path, cmd.Args, output)
+		logrus.Debugf("%s setupNetwork error: %v, %s", driverName, cmd.Args, output)
 		return err
 	}
 
 	cmd = exec.Command("ip", "link", "set", "dev", ifname, "up")
 	if output, err = cmd.CombinedOutput(); err != nil {
-		logrus.Debugf("%s setupNetwork error: %s %v, %s", driverName, cmd.Path, cmd.Args, output)
+		logrus.Debugf("%s setupNetwork error: %v, %s", driverName, cmd.Args, output)
 		return err
 	}
 
-- 
2.1.4

